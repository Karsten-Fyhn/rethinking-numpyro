<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Chapter 10. Big Entropy and the Generalized Linear Model | Statistical Rethinking (2nd ed.) with NumPyro</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Playfair+Display:700,900" rel="stylesheet">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="rss.xml">
<link rel="canonical" href="https://fehiepsi.github.io/rethinking-numpyro/10-big-entropy-and-the-generalized-linear-model.html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]--><meta name="author" content="fehiepsi">
<meta property="og:site_name" content="Statistical Rethinking (2nd ed.) with NumPyro">
<meta property="og:title" content="Chapter 10. Big Entropy and the Generalized Linear Model">
<meta property="og:url" content="https://fehiepsi.github.io/rethinking-numpyro/10-big-entropy-and-the-generalized-linear-model.html">
<meta property="og:description" content="&lt; Chapter 9. Markov Chain Monte Carlo | Chapter 11. God Spiked the Integers &gt;

    
    
    
    









In [0]:

    
import arviz as az
import matplotlib.pyplot as plt

import jax.numpy as jnp
fr">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2020-07-27T15:52:24-05:00">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Header and menu bar -->
<div class="container">
      <header class="blog-header py-3"><div class="row nbb-header align-items-center">
          <div class="col-md-3 col-xs-2 col-sm-2" style="width: auto;">
            <button class="navbar-toggler navbar-light bg-light nbb-navbar-toggler" type="button" data-toggle="collapse" data-target=".bs-nav-collapsible" aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse bs-nav-collapsible bootblog4-search-form-holder">
                
            </div>
        </div>
          <div class="col-md-6 col-xs-10 col-sm-10 bootblog4-brand" style="width: auto;">
            <a class="navbar-brand blog-header-logo text-dark" href=".">

            <span id="blog-title">Statistical Rethinking (2nd ed.) with NumPyro</span>
        </a>
          </div>
            <div class="col-md-3 justify-content-end align-items-center bs-nav-collapsible collapse flex-collapse bootblog4-right-nav">
            <nav class="navbar navbar-light bg-white"><ul class="navbar-nav bootblog4-right-nav">
<li class="nav-item">
    <a href="10-big-entropy-and-the-generalized-linear-model.ipynb" id="sourcelink" class="nav-link">Source</a>
    </li>


                    
            </ul></nav>
</div>
    </div>
</header><nav class="navbar navbar-expand-md navbar-light bg-white static-top"><div class="collapse navbar-collapse bs-nav-collapsible" id="bs-navbar">
            <ul class="navbar-nav nav-fill d-flex w-100"></ul>
</div>
<!-- /.navbar-collapse -->
</nav>
</div>

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        
        
        
<article class="post-text storypage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="#" class="u-url">Chapter 10. Big Entropy and the Generalized Linear Model</a></h1>

        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <div>
<div class="cell border-box-sizing text_cell rendered">
    <div class="inner_cell">
    <div class="text_cell_render border-box-sizing rendered_html">
    <div class="navigation">
    <p><!-- NAVIGATION -->
&lt; <a href="09-markov-chain-monte-carlo.html">Chapter 9. Markov Chain Monte Carlo</a> | <a href="11-god-spiked-the-integers.html">Chapter 11. God Spiked the Integers</a> &gt;</p>

    </div>
    </div>
    </div>
    </div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [0]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">arviz</span> <span class="k">as</span> <span class="nn">az</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">import</span> <span class="nn">jax.numpy</span> <span class="k">as</span> <span class="nn">jnp</span>
<span class="kn">from</span> <span class="nn">jax</span> <span class="kn">import</span> <span class="n">random</span><span class="p">,</span> <span class="n">tree_map</span><span class="p">,</span> <span class="n">vmap</span>

<span class="kn">import</span> <span class="nn">numpyro.distributions</span> <span class="k">as</span> <span class="nn">dist</span>

<span class="o">%</span><span class="k">config</span> InlineBackend.figure_formats = ["svg"]
<span class="n">az</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">"arviz-darkgrid"</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-10.1">Code 10.1<a class="anchor-link" href="10-big-entropy-and-the-generalized-linear-model.html#Code-10.1">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">p</span><span class="p">[</span><span class="s2">"A"</span><span class="p">]</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">p</span><span class="p">[</span><span class="s2">"B"</span><span class="p">]</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">p</span><span class="p">[</span><span class="s2">"C"</span><span class="p">]</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">p</span><span class="p">[</span><span class="s2">"D"</span><span class="p">]</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">p</span><span class="p">[</span><span class="s2">"E"</span><span class="p">]</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-10.2">Code 10.2<a class="anchor-link" href="10-big-entropy-and-the-generalized-linear-model.html#Code-10.2">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">p_norm</span> <span class="o">=</span> <span class="n">tree_map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">q</span><span class="p">:</span> <span class="n">q</span> <span class="o">/</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">q</span><span class="p">),</span> <span class="n">p</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-10.3">Code 10.3<a class="anchor-link" href="10-big-entropy-and-the-generalized-linear-model.html#Code-10.3">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">H</span> <span class="o">=</span> <span class="n">tree_map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">q</span><span class="p">:</span> <span class="o">-</span><span class="n">jnp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">q</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">q</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">q</span><span class="p">))),</span> <span class="n">p_norm</span><span class="p">)</span>
<span class="n">H</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    
<div class="prompt output_prompt">
<span>Out[3]:</span>
</div>




<div class="output_text output_subarea output_execute_result">
<pre>{'A': DeviceArray(-0., dtype=float32),
 'B': DeviceArray(0.6390318, dtype=float32),
 'C': DeviceArray(0.95027053, dtype=float32),
 'D': DeviceArray(1.4708084, dtype=float32),
 'E': DeviceArray(1.609438, dtype=float32)}</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-10.4">Code 10.4<a class="anchor-link" href="10-big-entropy-and-the-generalized-linear-model.html#Code-10.4">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ways</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">1260</span><span class="p">,</span> <span class="mi">37800</span><span class="p">,</span> <span class="mi">113400</span><span class="p">])</span>
<span class="n">logwayspp</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">ways</span><span class="p">)</span> <span class="o">/</span> <span class="mi">10</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-10.5">Code 10.5<a class="anchor-link" href="10-big-entropy-and-the-generalized-linear-model.html#Code-10.5">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># build list of the candidate distributions</span>
<span class="n">p</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span> <span class="o">/</span> <span class="mi">6</span><span class="p">])</span>
<span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span> <span class="o">/</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span> <span class="o">/</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">6</span><span class="p">])</span>
<span class="n">p</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">4</span> <span class="o">/</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span> <span class="o">/</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">8</span><span class="p">])</span>

<span class="c1"># compute expected value of each</span>
<span class="n">tree_map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">p</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">p</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])),</span> <span class="n">p</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    
<div class="prompt output_prompt">
<span>Out[5]:</span>
</div>




<div class="output_text output_subarea output_execute_result">
<pre>{1: DeviceArray(1., dtype=float32),
 2: DeviceArray(1., dtype=float32),
 3: DeviceArray(1., dtype=float32),
 4: DeviceArray(1., dtype=float32)}</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-10.6">Code 10.6<a class="anchor-link" href="10-big-entropy-and-the-generalized-linear-model.html#Code-10.6">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># compute entropy of each distribution</span>
<span class="n">tree_map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">p</span><span class="p">:</span> <span class="o">-</span><span class="n">jnp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">p</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">p</span><span class="p">)),</span> <span class="n">p</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    
<div class="prompt output_prompt">
<span>Out[6]:</span>
</div>




<div class="output_text output_subarea output_execute_result">
<pre>{1: DeviceArray(1.3862944, dtype=float32),
 2: DeviceArray(1.3296614, dtype=float32),
 3: DeviceArray(1.3296614, dtype=float32),
 4: DeviceArray(1.2130076, dtype=float32)}</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-10.7">Code 10.7<a class="anchor-link" href="10-big-entropy-and-the-generalized-linear-model.html#Code-10.7">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="mf">0.7</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">p</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">p</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">p</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">p</span><span class="p">)</span> <span class="o">*</span> <span class="n">p</span><span class="p">,</span> <span class="n">p</span> <span class="o">**</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">A</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    
<div class="prompt output_prompt">
<span>Out[7]:</span>
</div>




<div class="output_text output_subarea output_execute_result">
<pre>DeviceArray([0.09, 0.21, 0.21, 0.49], dtype=float32)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-10.8">Code 10.8<a class="anchor-link" href="10-big-entropy-and-the-generalized-linear-model.html#Code-10.8">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">-</span><span class="n">jnp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">A</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">A</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    
<div class="prompt output_prompt">
<span>Out[8]:</span>
</div>




<div class="output_text output_subarea output_execute_result">
<pre>DeviceArray(1.2217286, dtype=float32)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-10.9">Code 10.9<a class="anchor-link" href="10-big-entropy-and-the-generalized-linear-model.html#Code-10.9">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">sim_p</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">G</span><span class="o">=</span><span class="mf">1.4</span><span class="p">):</span>
    <span class="n">x123</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">Uniform</span><span class="p">()</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">PRNGKey</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,))</span>
    <span class="n">x4</span> <span class="o">=</span> <span class="p">(</span><span class="n">G</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">x123</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-</span> <span class="n">x123</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x123</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">-</span> <span class="n">G</span><span class="p">)</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">x123</span><span class="p">,</span> <span class="n">x4</span><span class="p">]))</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">x123</span><span class="p">,</span> <span class="n">x4</span><span class="p">])</span> <span class="o">/</span> <span class="n">z</span>
    <span class="k">return</span> <span class="p">{</span><span class="s2">"H"</span><span class="p">:</span> <span class="o">-</span><span class="n">jnp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">p</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">p</span><span class="p">)),</span> <span class="s2">"p"</span><span class="p">:</span> <span class="n">p</span><span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-10.10">Code 10.10<a class="anchor-link" href="10-big-entropy-and-the-generalized-linear-model.html#Code-10.10">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">H</span> <span class="o">=</span> <span class="n">vmap</span><span class="p">(</span><span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">sim_p</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">G</span><span class="o">=</span><span class="mf">1.4</span><span class="p">))(</span><span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mf">1e5</span><span class="p">)))</span>
<span class="n">az</span><span class="o">.</span><span class="n">plot_kde</span><span class="p">(</span><span class="n">H</span><span class="p">[</span><span class="s2">"H"</span><span class="p">],</span> <span class="n">bw</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    
<div class="prompt output_prompt">
<span>Out[10]:</span>
</div>



<div class="output_svg output_subarea ">
<?xml version="1.0" encoding="utf-8" standalone="no"?><!-- Created with matplotlib (https://matplotlib.org/) --><svg height="353.99952pt" version="1.1" viewbox="0 0 526.79952 353.99952" width="526.79952pt" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><style type="text/css">
*{stroke-linecap:butt;stroke-linejoin:round;}
  </style></defs><g id="figure_1"><g id="patch_1"><path d="M 0 353.99952 
L 526.79952 353.99952 
L 526.79952 0 
L 0 0 
z
" style="fill:#ffffff;"></path></g><g id="axes_1"><g id="patch_2"><path d="M 28.515 329.750145 
L 519.59952 329.750145 
L 519.59952 7.2 
L 28.515 7.2 
z
" style="fill:#eeeeee;"></path></g><g id="matplotlib.axis_1"><g id="xtick_1"><g id="line2d_1"><path clip-path="url(#pcc4fd9cc98)" d="M 32.376026 329.750145 
L 32.376026 7.2 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_2"></g><g id="text_1"><!-- 0.6 --><defs><path d="M 31.78125 66.40625 
Q 24.171875 66.40625 20.328125 58.90625 
Q 16.5 51.421875 16.5 36.375 
Q 16.5 21.390625 20.328125 13.890625 
Q 24.171875 6.390625 31.78125 6.390625 
Q 39.453125 6.390625 43.28125 13.890625 
Q 47.125 21.390625 47.125 36.375 
Q 47.125 51.421875 43.28125 58.90625 
Q 39.453125 66.40625 31.78125 66.40625 
z
M 31.78125 74.21875 
Q 44.046875 74.21875 50.515625 64.515625 
Q 56.984375 54.828125 56.984375 36.375 
Q 56.984375 17.96875 50.515625 8.265625 
Q 44.046875 -1.421875 31.78125 -1.421875 
Q 19.53125 -1.421875 13.0625 8.265625 
Q 6.59375 17.96875 6.59375 36.375 
Q 6.59375 54.828125 13.0625 64.515625 
Q 19.53125 74.21875 31.78125 74.21875 
z
" id="DejaVuSans-48"></path><path d="M 10.6875 12.40625 
L 21 12.40625 
L 21 0 
L 10.6875 0 
z
" id="DejaVuSans-46"></path><path d="M 33.015625 40.375 
Q 26.375 40.375 22.484375 35.828125 
Q 18.609375 31.296875 18.609375 23.390625 
Q 18.609375 15.53125 22.484375 10.953125 
Q 26.375 6.390625 33.015625 6.390625 
Q 39.65625 6.390625 43.53125 10.953125 
Q 47.40625 15.53125 47.40625 23.390625 
Q 47.40625 31.296875 43.53125 35.828125 
Q 39.65625 40.375 33.015625 40.375 
z
M 52.59375 71.296875 
L 52.59375 62.3125 
Q 48.875 64.0625 45.09375 64.984375 
Q 41.3125 65.921875 37.59375 65.921875 
Q 27.828125 65.921875 22.671875 59.328125 
Q 17.53125 52.734375 16.796875 39.40625 
Q 19.671875 43.65625 24.015625 45.921875 
Q 28.375 48.1875 33.59375 48.1875 
Q 44.578125 48.1875 50.953125 41.515625 
Q 57.328125 34.859375 57.328125 23.390625 
Q 57.328125 12.15625 50.6875 5.359375 
Q 44.046875 -1.421875 33.015625 -1.421875 
Q 20.359375 -1.421875 13.671875 8.265625 
Q 6.984375 17.96875 6.984375 36.375 
Q 6.984375 53.65625 15.1875 63.9375 
Q 23.390625 74.21875 37.203125 74.21875 
Q 40.921875 74.21875 44.703125 73.484375 
Q 48.484375 72.75 52.59375 71.296875 
z
" id="DejaVuSans-54"></path></defs><g style="fill:#262626;" transform="translate(21.243839 343.887957)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-48"></use><use x="63.623047" xlink:href="#DejaVuSans-46"></use><use x="95.410156" xlink:href="#DejaVuSans-54"></use></g></g></g><g id="xtick_2"><g id="line2d_3"><path clip-path="url(#pcc4fd9cc98)" d="M 107.151702 329.750145 
L 107.151702 7.2 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_4"></g><g id="text_2"><!-- 0.7 --><defs><path d="M 8.203125 72.90625 
L 55.078125 72.90625 
L 55.078125 68.703125 
L 28.609375 0 
L 18.3125 0 
L 43.21875 64.59375 
L 8.203125 64.59375 
z
" id="DejaVuSans-55"></path></defs><g style="fill:#262626;" transform="translate(96.019515 343.887957)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-48"></use><use x="63.623047" xlink:href="#DejaVuSans-46"></use><use x="95.410156" xlink:href="#DejaVuSans-55"></use></g></g></g><g id="xtick_3"><g id="line2d_5"><path clip-path="url(#pcc4fd9cc98)" d="M 181.927379 329.750145 
L 181.927379 7.2 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_6"></g><g id="text_3"><!-- 0.8 --><defs><path d="M 31.78125 34.625 
Q 24.75 34.625 20.71875 30.859375 
Q 16.703125 27.09375 16.703125 20.515625 
Q 16.703125 13.921875 20.71875 10.15625 
Q 24.75 6.390625 31.78125 6.390625 
Q 38.8125 6.390625 42.859375 10.171875 
Q 46.921875 13.96875 46.921875 20.515625 
Q 46.921875 27.09375 42.890625 30.859375 
Q 38.875 34.625 31.78125 34.625 
z
M 21.921875 38.8125 
Q 15.578125 40.375 12.03125 44.71875 
Q 8.5 49.078125 8.5 55.328125 
Q 8.5 64.0625 14.71875 69.140625 
Q 20.953125 74.21875 31.78125 74.21875 
Q 42.671875 74.21875 48.875 69.140625 
Q 55.078125 64.0625 55.078125 55.328125 
Q 55.078125 49.078125 51.53125 44.71875 
Q 48 40.375 41.703125 38.8125 
Q 48.828125 37.15625 52.796875 32.3125 
Q 56.78125 27.484375 56.78125 20.515625 
Q 56.78125 9.90625 50.3125 4.234375 
Q 43.84375 -1.421875 31.78125 -1.421875 
Q 19.734375 -1.421875 13.25 4.234375 
Q 6.78125 9.90625 6.78125 20.515625 
Q 6.78125 27.484375 10.78125 32.3125 
Q 14.796875 37.15625 21.921875 38.8125 
z
M 18.3125 54.390625 
Q 18.3125 48.734375 21.84375 45.5625 
Q 25.390625 42.390625 31.78125 42.390625 
Q 38.140625 42.390625 41.71875 45.5625 
Q 45.3125 48.734375 45.3125 54.390625 
Q 45.3125 60.0625 41.71875 63.234375 
Q 38.140625 66.40625 31.78125 66.40625 
Q 25.390625 66.40625 21.84375 63.234375 
Q 18.3125 60.0625 18.3125 54.390625 
z
" id="DejaVuSans-56"></path></defs><g style="fill:#262626;" transform="translate(170.795191 343.887957)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-48"></use><use x="63.623047" xlink:href="#DejaVuSans-46"></use><use x="95.410156" xlink:href="#DejaVuSans-56"></use></g></g></g><g id="xtick_4"><g id="line2d_7"><path clip-path="url(#pcc4fd9cc98)" d="M 256.703055 329.750145 
L 256.703055 7.2 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_8"></g><g id="text_4"><!-- 0.9 --><defs><path d="M 10.984375 1.515625 
L 10.984375 10.5 
Q 14.703125 8.734375 18.5 7.8125 
Q 22.3125 6.890625 25.984375 6.890625 
Q 35.75 6.890625 40.890625 13.453125 
Q 46.046875 20.015625 46.78125 33.40625 
Q 43.953125 29.203125 39.59375 26.953125 
Q 35.25 24.703125 29.984375 24.703125 
Q 19.046875 24.703125 12.671875 31.3125 
Q 6.296875 37.9375 6.296875 49.421875 
Q 6.296875 60.640625 12.9375 67.421875 
Q 19.578125 74.21875 30.609375 74.21875 
Q 43.265625 74.21875 49.921875 64.515625 
Q 56.59375 54.828125 56.59375 36.375 
Q 56.59375 19.140625 48.40625 8.859375 
Q 40.234375 -1.421875 26.421875 -1.421875 
Q 22.703125 -1.421875 18.890625 -0.6875 
Q 15.09375 0.046875 10.984375 1.515625 
z
M 30.609375 32.421875 
Q 37.25 32.421875 41.125 36.953125 
Q 45.015625 41.5 45.015625 49.421875 
Q 45.015625 57.28125 41.125 61.84375 
Q 37.25 66.40625 30.609375 66.40625 
Q 23.96875 66.40625 20.09375 61.84375 
Q 16.21875 57.28125 16.21875 49.421875 
Q 16.21875 41.5 20.09375 36.953125 
Q 23.96875 32.421875 30.609375 32.421875 
z
" id="DejaVuSans-57"></path></defs><g style="fill:#262626;" transform="translate(245.570867 343.887957)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-48"></use><use x="63.623047" xlink:href="#DejaVuSans-46"></use><use x="95.410156" xlink:href="#DejaVuSans-57"></use></g></g></g><g id="xtick_5"><g id="line2d_9"><path clip-path="url(#pcc4fd9cc98)" d="M 331.478731 329.750145 
L 331.478731 7.2 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_10"></g><g id="text_5"><!-- 1.0 --><defs><path d="M 12.40625 8.296875 
L 28.515625 8.296875 
L 28.515625 63.921875 
L 10.984375 60.40625 
L 10.984375 69.390625 
L 28.421875 72.90625 
L 38.28125 72.90625 
L 38.28125 8.296875 
L 54.390625 8.296875 
L 54.390625 0 
L 12.40625 0 
z
" id="DejaVuSans-49"></path></defs><g style="fill:#262626;" transform="translate(320.346544 343.887957)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-49"></use><use x="63.623047" xlink:href="#DejaVuSans-46"></use><use x="95.410156" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_6"><g id="line2d_11"><path clip-path="url(#pcc4fd9cc98)" d="M 406.254407 329.750145 
L 406.254407 7.2 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_12"></g><g id="text_6"><!-- 1.1 --><g style="fill:#262626;" transform="translate(395.12222 343.887957)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-49"></use><use x="63.623047" xlink:href="#DejaVuSans-46"></use><use x="95.410156" xlink:href="#DejaVuSans-49"></use></g></g></g><g id="xtick_7"><g id="line2d_13"><path clip-path="url(#pcc4fd9cc98)" d="M 481.030084 329.750145 
L 481.030084 7.2 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_14"></g><g id="text_7"><!-- 1.2 --><defs><path d="M 19.1875 8.296875 
L 53.609375 8.296875 
L 53.609375 0 
L 7.328125 0 
L 7.328125 8.296875 
Q 12.9375 14.109375 22.625 23.890625 
Q 32.328125 33.6875 34.8125 36.53125 
Q 39.546875 41.84375 41.421875 45.53125 
Q 43.3125 49.21875 43.3125 52.78125 
Q 43.3125 58.59375 39.234375 62.25 
Q 35.15625 65.921875 28.609375 65.921875 
Q 23.96875 65.921875 18.8125 64.3125 
Q 13.671875 62.703125 7.8125 59.421875 
L 7.8125 69.390625 
Q 13.765625 71.78125 18.9375 73 
Q 24.125 74.21875 28.421875 74.21875 
Q 39.75 74.21875 46.484375 68.546875 
Q 53.21875 62.890625 53.21875 53.421875 
Q 53.21875 48.921875 51.53125 44.890625 
Q 49.859375 40.875 45.40625 35.40625 
Q 44.1875 33.984375 37.640625 27.21875 
Q 31.109375 20.453125 19.1875 8.296875 
z
" id="DejaVuSans-50"></path></defs><g style="fill:#262626;" transform="translate(469.897896 343.887957)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-49"></use><use x="63.623047" xlink:href="#DejaVuSans-46"></use><use x="95.410156" xlink:href="#DejaVuSans-50"></use></g></g></g></g><g id="matplotlib.axis_2"><g id="ytick_1"><g id="line2d_15"><path clip-path="url(#pcc4fd9cc98)" d="M 28.515 315.088775 
L 519.59952 315.088775 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_16"></g><g id="text_8"><!-- 0 --><g style="fill:#262626;" transform="translate(16.1075 320.407681)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-48"></use></g></g></g><g id="ytick_2"><g id="line2d_17"><path clip-path="url(#pcc4fd9cc98)" d="M 28.515 262.505165 
L 519.59952 262.505165 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_18"></g><g id="text_9"><!-- 2 --><g style="fill:#262626;" transform="translate(16.1075 267.824071)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-50"></use></g></g></g><g id="ytick_3"><g id="line2d_19"><path clip-path="url(#pcc4fd9cc98)" d="M 28.515 209.921555 
L 519.59952 209.921555 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_20"></g><g id="text_10"><!-- 4 --><defs><path d="M 37.796875 64.3125 
L 12.890625 25.390625 
L 37.796875 25.390625 
z
M 35.203125 72.90625 
L 47.609375 72.90625 
L 47.609375 25.390625 
L 58.015625 25.390625 
L 58.015625 17.1875 
L 47.609375 17.1875 
L 47.609375 0 
L 37.796875 0 
L 37.796875 17.1875 
L 4.890625 17.1875 
L 4.890625 26.703125 
z
" id="DejaVuSans-52"></path></defs><g style="fill:#262626;" transform="translate(16.1075 215.240461)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-52"></use></g></g></g><g id="ytick_4"><g id="line2d_21"><path clip-path="url(#pcc4fd9cc98)" d="M 28.515 157.337944 
L 519.59952 157.337944 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_22"></g><g id="text_11"><!-- 6 --><g style="fill:#262626;" transform="translate(16.1075 162.656851)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-54"></use></g></g></g><g id="ytick_5"><g id="line2d_23"><path clip-path="url(#pcc4fd9cc98)" d="M 28.515 104.754334 
L 519.59952 104.754334 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_24"></g><g id="text_12"><!-- 8 --><g style="fill:#262626;" transform="translate(16.1075 110.073241)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-56"></use></g></g></g><g id="ytick_6"><g id="line2d_25"><path clip-path="url(#pcc4fd9cc98)" d="M 28.515 52.170724 
L 519.59952 52.170724 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_26"></g><g id="text_13"><!-- 10 --><g style="fill:#262626;" transform="translate(7.2 57.48963)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-49"></use><use x="63.623047" xlink:href="#DejaVuSans-48"></use></g></g></g></g><g id="PolyCollection_1"><defs><path d="M 50.837024 -38.910745 
L 50.837024 -39.032822 
L 53.080443 -38.910745 
L 55.323863 -38.910745 
L 57.567282 -39.032822 
L 59.810701 -38.910745 
L 62.054121 -39.032822 
L 64.29754 -39.399051 
L 66.54096 -38.910745 
L 68.784379 -39.032822 
L 71.027799 -39.032822 
L 73.271218 -39.032822 
L 75.514638 -39.032822 
L 77.758057 -39.276974 
L 80.001477 -39.399051 
L 82.244896 -39.399051 
L 84.488316 -39.521127 
L 86.731735 -39.032822 
L 88.975154 -39.032822 
L 91.218574 -39.032822 
L 93.461993 -39.032822 
L 95.705413 -39.154898 
L 97.948832 -39.399051 
L 100.192252 -39.76528 
L 102.435671 -39.76528 
L 104.679091 -39.643203 
L 106.92251 -39.521127 
L 109.16593 -39.76528 
L 111.409349 -40.375661 
L 113.652769 -40.253585 
L 115.896188 -39.643203 
L 118.139607 -40.131509 
L 120.383027 -40.009432 
L 122.626446 -40.741891 
L 124.869866 -40.619814 
L 127.113285 -40.009432 
L 129.356705 -40.375661 
L 131.600124 -40.253585 
L 133.843544 -40.375661 
L 136.086963 -40.497738 
L 138.330383 -40.253585 
L 140.573802 -41.352272 
L 142.817222 -42.08473 
L 145.060641 -40.986043 
L 147.30406 -40.986043 
L 149.54748 -40.986043 
L 151.790899 -41.718501 
L 154.034319 -42.45096 
L 156.277738 -41.230196 
L 158.521158 -42.08473 
L 160.764577 -42.573036 
L 163.007997 -41.718501 
L 165.251416 -42.08473 
L 167.494836 -41.596425 
L 169.738255 -42.08473 
L 171.981675 -43.305494 
L 174.225094 -42.328883 
L 176.468513 -42.573036 
L 178.711933 -41.962654 
L 180.955352 -42.573036 
L 183.198772 -42.573036 
L 185.442191 -42.817189 
L 187.685611 -44.892487 
L 189.92903 -43.671723 
L 192.17245 -43.915876 
L 194.415869 -45.014563 
L 196.659289 -43.549647 
L 198.902708 -45.624945 
L 201.146128 -45.136639 
L 203.389547 -45.747021 
L 205.632966 -46.11325 
L 207.876386 -46.479479 
L 210.119805 -45.991174 
L 212.363225 -45.136639 
L 214.606644 -47.211937 
L 216.850064 -45.991174 
L 219.093483 -47.089861 
L 221.336903 -46.967785 
L 223.580322 -47.45609 
L 225.823742 -49.897617 
L 228.067161 -47.822319 
L 230.310581 -46.967785 
L 232.554 -50.385923 
L 234.797419 -49.409312 
L 237.040839 -48.188548 
L 239.284258 -49.897617 
L 241.527678 -49.165159 
L 243.771097 -51.48461 
L 246.014517 -50.14177 
L 248.257936 -52.094992 
L 250.501356 -53.315755 
L 252.744775 -54.17029 
L 254.988195 -52.82745 
L 257.231614 -53.193679 
L 259.475034 -52.82745 
L 261.718453 -55.879359 
L 263.961872 -56.001435 
L 266.205292 -57.344275 
L 268.448711 -56.001435 
L 270.692131 -59.785802 
L 272.93555 -58.931267 
L 275.17897 -60.274107 
L 277.422389 -60.396184 
L 279.665809 -63.081864 
L 281.909228 -63.692245 
L 284.152648 -64.913009 
L 286.396067 -63.326016 
L 288.639486 -67.842841 
L 290.882906 -65.88962 
L 293.126325 -67.110383 
L 295.369745 -71.016827 
L 297.613164 -73.458354 
L 299.856584 -72.725896 
L 302.100003 -79.073866 
L 304.343423 -77.975179 
L 306.586842 -79.684248 
L 308.830262 -85.29976 
L 311.073681 -83.468615 
L 313.317101 -87.98544 
L 315.56052 -94.33341 
L 317.803939 -94.33341 
L 320.047359 -92.868494 
L 322.290778 -94.211334 
L 324.534198 -95.065868 
L 326.777617 -97.385319 
L 329.021037 -99.70477 
L 331.264456 -96.652861 
L 333.507876 -100.070999 
L 335.751295 -106.296893 
L 337.994715 -104.831977 
L 340.238134 -103.244984 
L 342.481554 -103.977442 
L 344.724973 -106.785199 
L 346.968392 -113.011093 
L 349.211812 -114.598085 
L 351.455231 -114.353933 
L 353.698651 -116.429231 
L 355.94207 -119.359063 
L 358.18549 -117.405841 
L 360.428909 -117.772071 
L 362.672329 -118.626605 
L 364.915748 -120.946056 
L 367.159168 -128.392713 
L 369.402587 -123.997965 
L 371.646007 -128.026484 
L 373.889426 -126.561568 
L 376.132845 -131.810851 
L 378.376265 -132.055004 
L 380.619684 -138.769204 
L 382.863104 -137.792593 
L 385.106523 -142.9198 
L 387.349943 -144.018487 
L 389.593362 -140.112043 
L 391.836782 -146.093785 
L 394.080201 -145.849632 
L 396.323621 -153.662519 
L 398.56704 -155.371588 
L 400.81046 -159.400108 
L 403.053879 -156.348199 
L 405.297298 -168.311681 
L 407.540718 -161.475406 
L 409.784137 -173.316812 
L 412.027557 -178.321943 
L 414.270976 -170.142827 
L 416.514396 -180.031012 
L 418.757815 -179.542706 
L 421.001235 -177.955713 
L 423.244654 -188.45428 
L 425.488074 -183.693302 
L 427.731493 -192.726952 
L 429.974913 -191.628265 
L 432.218332 -196.633396 
L 434.461751 -200.661916 
L 436.705171 -200.783992 
L 438.94859 -208.474802 
L 441.19201 -209.085184 
L 443.435429 -214.700696 
L 445.678849 -213.479933 
L 447.922268 -214.334467 
L 450.165688 -223.61227 
L 452.409107 -226.29795 
L 454.652527 -229.349859 
L 456.895946 -233.622531 
L 459.139366 -242.0458 
L 461.382785 -242.289953 
L 463.626204 -241.923723 
L 465.869624 -251.567756 
L 468.113043 -247.417159 
L 470.356463 -247.295083 
L 472.599882 -252.788519 
L 474.843302 -249.980763 
L 477.086721 -252.666443 
L 479.330141 -264.996155 
L 481.57356 -255.596275 
L 483.81698 -262.432551 
L 486.060399 -274.51811 
L 488.303819 -270.85582 
L 490.547238 -281.598539 
L 492.790657 -290.632189 
L 495.034077 -295.393167 
L 497.277496 -332.13815 
L 497.277496 -38.910745 
L 497.277496 -38.910745 
L 495.034077 -38.910745 
L 492.790657 -38.910745 
L 490.547238 -38.910745 
L 488.303819 -38.910745 
L 486.060399 -38.910745 
L 483.81698 -38.910745 
L 481.57356 -38.910745 
L 479.330141 -38.910745 
L 477.086721 -38.910745 
L 474.843302 -38.910745 
L 472.599882 -38.910745 
L 470.356463 -38.910745 
L 468.113043 -38.910745 
L 465.869624 -38.910745 
L 463.626204 -38.910745 
L 461.382785 -38.910745 
L 459.139366 -38.910745 
L 456.895946 -38.910745 
L 454.652527 -38.910745 
L 452.409107 -38.910745 
L 450.165688 -38.910745 
L 447.922268 -38.910745 
L 445.678849 -38.910745 
L 443.435429 -38.910745 
L 441.19201 -38.910745 
L 438.94859 -38.910745 
L 436.705171 -38.910745 
L 434.461751 -38.910745 
L 432.218332 -38.910745 
L 429.974913 -38.910745 
L 427.731493 -38.910745 
L 425.488074 -38.910745 
L 423.244654 -38.910745 
L 421.001235 -38.910745 
L 418.757815 -38.910745 
L 416.514396 -38.910745 
L 414.270976 -38.910745 
L 412.027557 -38.910745 
L 409.784137 -38.910745 
L 407.540718 -38.910745 
L 405.297298 -38.910745 
L 403.053879 -38.910745 
L 400.81046 -38.910745 
L 398.56704 -38.910745 
L 396.323621 -38.910745 
L 394.080201 -38.910745 
L 391.836782 -38.910745 
L 389.593362 -38.910745 
L 387.349943 -38.910745 
L 385.106523 -38.910745 
L 382.863104 -38.910745 
L 380.619684 -38.910745 
L 378.376265 -38.910745 
L 376.132845 -38.910745 
L 373.889426 -38.910745 
L 371.646007 -38.910745 
L 369.402587 -38.910745 
L 367.159168 -38.910745 
L 364.915748 -38.910745 
L 362.672329 -38.910745 
L 360.428909 -38.910745 
L 358.18549 -38.910745 
L 355.94207 -38.910745 
L 353.698651 -38.910745 
L 351.455231 -38.910745 
L 349.211812 -38.910745 
L 346.968392 -38.910745 
L 344.724973 -38.910745 
L 342.481554 -38.910745 
L 340.238134 -38.910745 
L 337.994715 -38.910745 
L 335.751295 -38.910745 
L 333.507876 -38.910745 
L 331.264456 -38.910745 
L 329.021037 -38.910745 
L 326.777617 -38.910745 
L 324.534198 -38.910745 
L 322.290778 -38.910745 
L 320.047359 -38.910745 
L 317.803939 -38.910745 
L 315.56052 -38.910745 
L 313.317101 -38.910745 
L 311.073681 -38.910745 
L 308.830262 -38.910745 
L 306.586842 -38.910745 
L 304.343423 -38.910745 
L 302.100003 -38.910745 
L 299.856584 -38.910745 
L 297.613164 -38.910745 
L 295.369745 -38.910745 
L 293.126325 -38.910745 
L 290.882906 -38.910745 
L 288.639486 -38.910745 
L 286.396067 -38.910745 
L 284.152648 -38.910745 
L 281.909228 -38.910745 
L 279.665809 -38.910745 
L 277.422389 -38.910745 
L 275.17897 -38.910745 
L 272.93555 -38.910745 
L 270.692131 -38.910745 
L 268.448711 -38.910745 
L 266.205292 -38.910745 
L 263.961872 -38.910745 
L 261.718453 -38.910745 
L 259.475034 -38.910745 
L 257.231614 -38.910745 
L 254.988195 -38.910745 
L 252.744775 -38.910745 
L 250.501356 -38.910745 
L 248.257936 -38.910745 
L 246.014517 -38.910745 
L 243.771097 -38.910745 
L 241.527678 -38.910745 
L 239.284258 -38.910745 
L 237.040839 -38.910745 
L 234.797419 -38.910745 
L 232.554 -38.910745 
L 230.310581 -38.910745 
L 228.067161 -38.910745 
L 225.823742 -38.910745 
L 223.580322 -38.910745 
L 221.336903 -38.910745 
L 219.093483 -38.910745 
L 216.850064 -38.910745 
L 214.606644 -38.910745 
L 212.363225 -38.910745 
L 210.119805 -38.910745 
L 207.876386 -38.910745 
L 205.632966 -38.910745 
L 203.389547 -38.910745 
L 201.146128 -38.910745 
L 198.902708 -38.910745 
L 196.659289 -38.910745 
L 194.415869 -38.910745 
L 192.17245 -38.910745 
L 189.92903 -38.910745 
L 187.685611 -38.910745 
L 185.442191 -38.910745 
L 183.198772 -38.910745 
L 180.955352 -38.910745 
L 178.711933 -38.910745 
L 176.468513 -38.910745 
L 174.225094 -38.910745 
L 171.981675 -38.910745 
L 169.738255 -38.910745 
L 167.494836 -38.910745 
L 165.251416 -38.910745 
L 163.007997 -38.910745 
L 160.764577 -38.910745 
L 158.521158 -38.910745 
L 156.277738 -38.910745 
L 154.034319 -38.910745 
L 151.790899 -38.910745 
L 149.54748 -38.910745 
L 147.30406 -38.910745 
L 145.060641 -38.910745 
L 142.817222 -38.910745 
L 140.573802 -38.910745 
L 138.330383 -38.910745 
L 136.086963 -38.910745 
L 133.843544 -38.910745 
L 131.600124 -38.910745 
L 129.356705 -38.910745 
L 127.113285 -38.910745 
L 124.869866 -38.910745 
L 122.626446 -38.910745 
L 120.383027 -38.910745 
L 118.139607 -38.910745 
L 115.896188 -38.910745 
L 113.652769 -38.910745 
L 111.409349 -38.910745 
L 109.16593 -38.910745 
L 106.92251 -38.910745 
L 104.679091 -38.910745 
L 102.435671 -38.910745 
L 100.192252 -38.910745 
L 97.948832 -38.910745 
L 95.705413 -38.910745 
L 93.461993 -38.910745 
L 91.218574 -38.910745 
L 88.975154 -38.910745 
L 86.731735 -38.910745 
L 84.488316 -38.910745 
L 82.244896 -38.910745 
L 80.001477 -38.910745 
L 77.758057 -38.910745 
L 75.514638 -38.910745 
L 73.271218 -38.910745 
L 71.027799 -38.910745 
L 68.784379 -38.910745 
L 66.54096 -38.910745 
L 64.29754 -38.910745 
L 62.054121 -38.910745 
L 59.810701 -38.910745 
L 57.567282 -38.910745 
L 55.323863 -38.910745 
L 53.080443 -38.910745 
L 50.837024 -38.910745 
z
" id="mdb16b61afb" style="stroke:#2a2eec;stroke-opacity:0;"></path></defs><g clip-path="url(#pcc4fd9cc98)"><use style="fill:#2a2eec;fill-opacity:0;stroke:#2a2eec;stroke-opacity:0;" x="0" xlink:href="#mdb16b61afb" y="353.99952"></use></g></g><g id="line2d_27"><path clip-path="url(#pcc4fd9cc98)" d="M 50.837024 314.966698 
L 53.080443 315.088775 
L 55.323863 315.088775 
L 57.567282 314.966698 
L 59.810701 315.088775 
L 62.054121 314.966698 
L 64.29754 314.600469 
L 66.54096 315.088775 
L 68.784379 314.966698 
L 75.514638 314.966698 
L 77.758057 314.722546 
L 80.001477 314.600469 
L 82.244896 314.600469 
L 84.488316 314.478393 
L 86.731735 314.966698 
L 93.461993 314.966698 
L 95.705413 314.844622 
L 97.948832 314.600469 
L 100.192252 314.23424 
L 102.435671 314.23424 
L 106.92251 314.478393 
L 109.16593 314.23424 
L 111.409349 313.623859 
L 113.652769 313.745935 
L 115.896188 314.356317 
L 118.139607 313.868011 
L 120.383027 313.990088 
L 122.626446 313.257629 
L 124.869866 313.379706 
L 127.113285 313.990088 
L 129.356705 313.623859 
L 131.600124 313.745935 
L 136.086963 313.501782 
L 138.330383 313.745935 
L 140.573802 312.647248 
L 142.817222 311.91479 
L 145.060641 313.013477 
L 149.54748 313.013477 
L 154.034319 311.54856 
L 156.277738 312.769324 
L 158.521158 311.91479 
L 160.764577 311.426484 
L 163.007997 312.281019 
L 165.251416 311.91479 
L 167.494836 312.403095 
L 169.738255 311.91479 
L 171.981675 310.694026 
L 174.225094 311.670637 
L 176.468513 311.426484 
L 178.711933 312.036866 
L 180.955352 311.426484 
L 183.198772 311.426484 
L 185.442191 311.182331 
L 187.685611 309.107033 
L 189.92903 310.327797 
L 192.17245 310.083644 
L 194.415869 308.984957 
L 196.659289 310.449873 
L 198.902708 308.374575 
L 201.146128 308.862881 
L 203.389547 308.252499 
L 207.876386 307.520041 
L 210.119805 308.008346 
L 212.363225 308.862881 
L 214.606644 306.787583 
L 216.850064 308.008346 
L 219.093483 306.909659 
L 221.336903 307.031735 
L 223.580322 306.54343 
L 225.823742 304.101903 
L 228.067161 306.177201 
L 230.310581 307.031735 
L 232.554 303.613597 
L 234.797419 304.590208 
L 237.040839 305.810972 
L 239.284258 304.101903 
L 241.527678 304.834361 
L 243.771097 302.51491 
L 246.014517 303.85775 
L 248.257936 301.904528 
L 250.501356 300.683765 
L 252.744775 299.82923 
L 254.988195 301.17207 
L 257.231614 300.805841 
L 259.475034 301.17207 
L 261.718453 298.120161 
L 263.961872 297.998085 
L 266.205292 296.655245 
L 268.448711 297.998085 
L 270.692131 294.213718 
L 272.93555 295.068253 
L 275.17897 293.725413 
L 277.422389 293.603336 
L 279.665809 290.917656 
L 281.909228 290.307275 
L 284.152648 289.086511 
L 286.396067 290.673504 
L 288.639486 286.156679 
L 290.882906 288.1099 
L 293.126325 286.889137 
L 295.369745 282.982693 
L 297.613164 280.541166 
L 299.856584 281.273624 
L 302.100003 274.925654 
L 304.343423 276.024341 
L 306.586842 274.315272 
L 308.830262 268.69976 
L 311.073681 270.530905 
L 313.317101 266.01408 
L 315.56052 259.66611 
L 317.803939 259.66611 
L 320.047359 261.131026 
L 322.290778 259.788186 
L 324.534198 258.933652 
L 329.021037 254.29475 
L 331.264456 257.346659 
L 333.507876 253.928521 
L 335.751295 247.702627 
L 340.238134 250.754536 
L 342.481554 250.022078 
L 344.724973 247.214321 
L 346.968392 240.988427 
L 349.211812 239.401435 
L 351.455231 239.645587 
L 353.698651 237.570289 
L 355.94207 234.640457 
L 358.18549 236.593679 
L 360.428909 236.227449 
L 362.672329 235.372915 
L 364.915748 233.053464 
L 367.159168 225.606807 
L 369.402587 230.001555 
L 371.646007 225.973036 
L 373.889426 227.437952 
L 376.132845 222.188669 
L 378.376265 221.944516 
L 380.619684 215.230316 
L 382.863104 216.206927 
L 385.106523 211.07972 
L 387.349943 209.981033 
L 389.593362 213.887477 
L 391.836782 207.905735 
L 394.080201 208.149888 
L 396.323621 200.337001 
L 398.56704 198.627932 
L 400.81046 194.599412 
L 403.053879 197.651321 
L 405.297298 185.687839 
L 407.540718 192.524114 
L 409.784137 180.682708 
L 412.027557 175.677577 
L 414.270976 183.856693 
L 416.514396 173.968508 
L 418.757815 174.456814 
L 421.001235 176.043807 
L 423.244654 165.54524 
L 425.488074 170.306218 
L 427.731493 161.272568 
L 429.974913 162.371255 
L 432.218332 157.366124 
L 434.461751 153.337604 
L 436.705171 153.215528 
L 438.94859 145.524718 
L 441.19201 144.914336 
L 443.435429 139.298824 
L 445.678849 140.519587 
L 447.922268 139.665053 
L 450.165688 130.38725 
L 452.409107 127.70157 
L 454.652527 124.649661 
L 456.895946 120.376989 
L 459.139366 111.95372 
L 461.382785 111.709567 
L 463.626204 112.075797 
L 465.869624 102.431764 
L 468.113043 106.582361 
L 470.356463 106.704437 
L 472.599882 101.211001 
L 474.843302 104.018757 
L 477.086721 101.333077 
L 479.330141 89.003365 
L 481.57356 98.403245 
L 483.81698 91.566969 
L 486.060399 79.48141 
L 488.303819 83.1437 
L 490.547238 72.400981 
L 492.790657 63.367331 
L 495.034077 58.606353 
L 497.277496 21.86137 
L 497.277496 21.86137 
" style="fill:none;stroke:#2a2eec;stroke-linecap:round;stroke-width:1.5;"></path></g><g id="patch_3"><path d="M 28.515 329.750145 
L 28.515 7.2 
" style="fill:none;"></path></g><g id="patch_4"><path d="M 519.59952 329.750145 
L 519.59952 7.2 
" style="fill:none;"></path></g><g id="patch_5"><path d="M 28.515 329.750145 
L 519.59952 329.750145 
" style="fill:none;"></path></g><g id="patch_6"><path d="M 28.515 7.2 
L 519.59952 7.2 
" style="fill:none;"></path></g></g></g><defs><clippath id="pcc4fd9cc98"><rect height="322.550145" width="491.08452" x="28.515" y="7.2"></rect></clippath></defs></svg>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-10.11">Code 10.11<a class="anchor-link" href="10-big-entropy-and-the-generalized-linear-model.html#Code-10.11">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">entropies</span> <span class="o">=</span> <span class="n">H</span><span class="p">[</span><span class="s2">"H"</span><span class="p">]</span>
<span class="n">distributions</span> <span class="o">=</span> <span class="n">H</span><span class="p">[</span><span class="s2">"p"</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-10.12">Code 10.12<a class="anchor-link" href="10-big-entropy-and-the-generalized-linear-model.html#Code-10.12">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [12]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">jnp</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">entropies</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    
<div class="prompt output_prompt">
<span>Out[12]:</span>
</div>




<div class="output_text output_subarea output_execute_result">
<pre>DeviceArray(1.2217282, dtype=float32)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-10.13">Code 10.13<a class="anchor-link" href="10-big-entropy-and-the-generalized-linear-model.html#Code-10.13">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [13]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">distributions</span><span class="p">[</span><span class="n">jnp</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">entropies</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    
<div class="prompt output_prompt">
<span>Out[13]:</span>
</div>




<div class="output_text output_subarea output_execute_result">
<pre>DeviceArray([0.09018064, 0.20994425, 0.20969447, 0.49018064], dtype=float32)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
    <div class="inner_cell">
    <div class="text_cell_render border-box-sizing rendered_html">
    <div class="navigation">
    <p><!-- NAVIGATION -->
&lt; <a href="09-markov-chain-monte-carlo.html">Chapter 9. Markov Chain Monte Carlo</a> | <a href="11-god-spiked-the-integers.html">Chapter 11. God Spiked the Integers</a> &gt;</p>

    </div>
    </div>
    </div>
    </div>
</div>
    </div>
    
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" integrity="sha384-3lJUsx1TJHt7BA4udB5KPnDrlkO8T6J6v/op7ui0BbCjvZ9WqV4Xm6DTP6kQ/iBH" crossorigin="anonymous"></script><script type="text/x-mathjax-config">
        MathJax.Hub.Config({tex2jax: {inlineMath: [['$latex ','$'], ['\\(','\\)']]}});
        </script></article><!--End of body content--><footer id="footer">
            Contents © 2020         <a href="mailto:fehiepsi@gmail.com">Du Phan</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
<a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
<img alt="Creative Commons License BY-NC-SA" style="border-width:0; margin-bottom:12px;" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png"></a>
            
            
        </footer>
</div>
</div>


        <script src="assets/js/all-nocdn.js"></script><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-131299125-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-131299125-1');
</script>
</body>
</html>
